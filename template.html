<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DO NOT USE</title>
    <style>
      /* Make the main heading 10% of the viewport height,
         and all other h1s 5% of the viewport height. */
      h1 {
        font-family: 'Courier New', Courier, monospace;
        margin: 0; /* remove default margins so height is predictable */
      }

      /* Primary heading (DEBUG's CreditCow) */
      h1.primary {
        height: 10vh;            /* 10% of viewport height */
        display: flex;
        align-items: center;     /* vertical centering */
        justify-content: center; /* horizontal centering */
        font-size: 6vh;          /* scale font to fit the area */
      }

      /* All other h1 elements */
      h1.secondary {
        height: 5vh;             /* 5% of viewport height */
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 3vh;          /* scale font to fit the smaller area */
      }

      /* Ensure buttons have some spacing so they don't overlap headings */
      .controls {
        margin: 12px 0;
      }
    </style>
</head>
<body>
    
    <h1 class="primary">DEBUG's CreditCow</h1>
    <h1 class="secondary">Your public receiver ID: 1</h1>

    <div class="controls">
      <button id="btn-add">Add 1 to send</button>
      <button id="btn-subtract">Subtract 1 from send</button>
    </div>

    <h1 id="output-area1" class="secondary">this shall be switched</h1>
     <label for="sendID">sendID:</label>
  <input type="text" id="sendID" name="sendID" placeholder="What is the sendID of your target">
  <button id="submitBtn" type="button">Submit</button>
  <script>
    const btn = document.getElementById('submitBtn');
    const input = document.getElementById('cowID');

    btn.addEventListener('click', function()
      const ID = input.value.trim();

        //
        //
        //
        //
        // Use a proper JS declaration
      let sendTotal = 0;

      function updateDisplay() {
        const out = document.getElementById("output-area1");
        const btnSub = document.getElementById("btn-subtract");
        if (out) out.textContent = sendTotal;
        // Disable subtract when at zero to prevent negative values
        if (btnSub) btnSub.disabled = sendTotal <= 0;
      }

      function add() {
        sendTotal++;
        updateDisplay();
      }

      function subtract() {
        // Prevent going below 0
        if (sendTotal > 0) {
          sendTotal--;
          updateDisplay();
        }
      }

      // Wire buttons (preferred over inline onclick)
      document.getElementById("btn-add").addEventListener("click", add);
      document.getElementById("btn-subtract").addEventListener("click", subtract);

      // Initialize display
      updateDisplay();
        
//
//
//
//
        async function subtractAndSync() {
  const GITHUB_TOKEN = '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'; // Requires 'repo' scope
  const OWNER = 'coolgames555';
  const REPO = 'CreditCow';
  const PATH = 'data/${ID}.txt';
  const url = `https://api.github.com{OWNER}/${REPO}/contents/${PATH}`;

  try {
    // 1. Fetch current file data
    const response = await fetch(url, {
      headers: { Authorization: `Bearer ${GITHUB_TOKEN}` }
    });
    
    if (!response.ok) throw new Error("Could not find file");
    const fileData = await response.json();

    // 2. Decode content and subtract ID
    const currentVal = parseFloat(atob(fileData.content)); 
    const newVal = (currentVal - sendTotal).toString(); 

    // 3. Push updated value back to GitHub
    const updateRes = await fetch(url, {
      method: 'PUT',
      headers: {
        Authorization: `Bearer ${GITHUB_TOKEN}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        message: `used ${ID} from file`,
        content: btoa(newVal), // Re-encode to Base64
        sha: fileData.sha      // Required to overwrite existing file
      })
    });

    if (updateRes.ok) {
      console.log(`Update successful. New value: ${newVal}`);
    }
  } catch (error) {
    console.error("Error during sync:", error);
  }
}
        </script>
    <script>
      
    </script>
</body>
</html>
